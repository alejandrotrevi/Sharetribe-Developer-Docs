---
title: "How to set up OpenID Connect proxy in Sharetribe Web Template"
source: "provided"
extracted_date: "2025-09-04"
summary: "In this guide, we'll take a look at the process of setting up OpenID Connect (OIDC) proxy to Sharetribe Web Template. This allows you to add support for identity providers that Sharetribe doesn't natively support. In this example, we are building the proxy implementation for Github."
---

- [A note about development environments](#a-note-about-development-environments)
- [Create an OAuth app in Github](#create-an-oauth-app-in-github)
- [Configure a new identity provider and client in Sharetribe Console](#configure-a-new-identity-provider-and-client-in-sharetribe-console)
  - [Identity provider name and ID](#identity-provider-name-and-id)
  - [Identity provider URL](#identity-provider-url)
  - [Client ID](#client-id)
- [Build Github auth flow in Sharetribe Web Template](#build-github-auth-flow-in-sharetribe-web-template)
  - [Sharetribe Web Template as an OpenID Connect identity provider](#sharetribe-web-template-as-an-openid-connect-identity-provider)
  - [Generate an RSA key pair](#generate-an-rsa-key-pair)
  - [Configure Sharetribe Web Template](#configure-sharetribe-web-template)
  - [Add Passport module dependency](#add-passport-module-dependency)
  - [Implement the Github login flow in Sharetribe Web Template backend](#implement-the-github-login-flow-in-sharetribe-web-template-backend)
  - [Add a Github login button to Sharetribe Web Template](#add-a-github-login-button-to-sharetribe-web-template)
- [Troubleshooting your integration](#troubleshooting-your-integration)
  - [Inspect the id token](#inspect-the-id-token)
  - [Make sure your .well-known endpoints are available in the correct address](#make-sure-your-well-known-endpoints-are-available-in-the-correct-address)
  - [Double check your RSA key formatting](#double-check-your-rsa-key-formatting)

# How to set up OpenID Connect proxy in Sharetribe Web Template

The OpenID Connect (OIDC) support in Sharetribe allows you to integrate login solutions that do not necessarily implement OpenID Connect. The idea is to build a suitable login flow in Sharetribe Web Template and wrap that login information into an OpenID Connect ID token that can be used to validate user login in Sharetribe. With this approach, the template will serve as an identity provider towards Sharetribe.

Sharetribe verifies the ID token by

- fetching the JSON Web Key that is hosted by your template server, and
- using that to unsign the token.

A consequence of this is that the JSON Web Key needs to be publicly available. This means that the proxy setup will not work directly in localhost. To test out the Github login, you should e.g. [deploy your template changes to Render](https://www.sharetribe.com/docs/tutorial/deploy-to-render/).

In this guide, we'll integrate Github login to Sharetribe by using Sharetribe Web Template as an OIDC proxy to Sharetribe.

The main steps to take to achieve this are:

1. Create a OAuth app in Github
2. Configure a new identity provider and client in Sharetribe Console
3. Build Github auth flow in the template

**If you are working with one of our legacy templates and are not sure whether using Open ID Connect proxy is enabled, take a look at our [legacy documentation](https://www.sharetribe.com/docs/template/legacy-templates/).**

## A note about development environments

For OpenID Connect (OIDC) identity providers, Sharetribe supports RSA signed ID tokens. RSA is an asymmetric signing function. Therefore, all OIDC identity providers will need to provide their URL (also known as _issuer location_) to Sharetribe so that public signing keys can be fetched for ID token validation.

When using Sharetribe Web Template as an OIDC proxy, it should be served publicly, so that Sharetribe can fetch the public signing key used to sign ID tokens used with authentication. This means that when developing OIDC proxy capabilities, by default, a template application running in `localhost` can not be used as an OIDC proxy but the application should be deployed, for example, to a staging environment.

If you want to develop this functionality complete locally, take a look at tools like [Ngrok](https://ngrok.com/) or [Localtunnel](https://localtunnel.github.io/www/) that allow exposing your local ports publicly.

> **Information**
> 
> When serving the template via Ngrok, you'll want to make sure the _issuerUrl_ matches the URL generated by Ngrok where your site is accessible. This might default to localhost if your _NODE_ENV_ variable is set to _development_.
> 
> If you're using the _yarn run dev-server_ command to run the template, this command overwrites the REACT_APP_MARKETPLACE_ROOT_URL specified in the .env file. Ensure you update the command to match the URL where your site is being served through Ngrok.

## Create an OAuth app in Github

1. Head to [Github developer settings](https://github.com/settings/developers). A Github account is required.
2. Select "OAuth apps" in the left sidebar, and click "Register a new application".
3. Add application name and homepage URL. The name and URL are used to identify your application to the people signing in.
4. Add the Authorization callback URL: `<your marketplace URL>/api/auth/github/callback`. So for example, `https://www.mymarketplace.com/api/auth/github/callback`
5. Click "Register application".
6. Generate a client secret, and make a note of the client ID and client secret. You will need these values later on.

## Configure a new identity provider and client in Sharetribe Console

With this proxy implementation, **your Sharetribe Web Template works as the identity provider towards Sharetribe.** Sharetribe uses your template application to validate the ID token that wraps the Github login information. To enable logins in Sharetribe using the OIDC proxy, a corresponding identity provider and identity provider client need to be configured for your marketplace in Sharetribe Console. See the [OpenID Connect how-to guide](https://www.sharetribe.com/docs/how-to/enable-open-id-connect-login/#configure-an-identity-provider-client-in-console) for information on how to add a new identity provider for your marketplace.

Here's some guidance for configuring your template application as a new identity provider and a client to be used as a proxy for Github.

### Identity provider name and ID

The identity provider ID is generated based on the name of the IdP. The ID will be passed to the Sharetribe API when creating a user or logging in using the proxy. When a user logs in with an identity provider, their identity provider profile is linked to their user account and this relationship is exposed in the [currentUser resource](https://www.sharetribe.com/api-reference/marketplace.html#currentuser-identity-provider) in the Sharetribe API.

If the intention is to use the Sharetribe Web Template to proxy login to multiple services, it's advised to create a distinct identity provider for each, and name them so that the ID indicates what is the actual service providing the authentication. In Github's case the IdP name could be "Template Github" or "Template Github Proxy".

### Identity provider URL

Based on this URL, Sharetribe determines the path to an OpenID Connect discovery document (_[identity provider URL]/.well-known/openid-configuration_) and from there on to an ID token signing key.

In Open ID Connect terms, this is the issuer URL. In this setup, your Sharetribe Web Template acts as the issuer towards Sharetribe, so the URL should point to your template.

By default, the identity provider URL should be the root address of your template application, for example, _https://example.com_ or, for default Render URLs, _https://EXAMPLE.onrender.com_. Note, that this URL needs to be publicly hosted so a `localhost` URL will not work.

### Client ID

When using Sharetribe Web Template as on OpenID Connect proxy, you are in charge of generating a client ID. The value can be any randomly generated string.

## Build Github auth flow in Sharetribe Web Template

### Sharetribe Web Template as an OpenID